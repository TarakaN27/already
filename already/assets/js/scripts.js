(()=>{var t={322:()=>{class t{init=()=>{this.filmsNode=document.getElementById("films"),this.form=document.getElementById("filter"),this.searchInput=document.getElementById("catalog-search"),this.sortInput=document.querySelector('.catalog-container select[name="sort"]'),this.loadMoreBtn=document.querySelector(".catalog-container .js-load-more"),this.page=1,this.form.addEventListener("submit",this.onSubmit),this.sortInput.addEventListener("change",this.getFilms),this.searchInput.addEventListener("input",this.onSearch),this.loadMoreBtn.addEventListener("click",this.onLoadMore)};prepareFilterData=(t=!1)=>{t?(this.formData=new URLSearchParams,this.formData.set("s",this.searchInput.value)):this.formData=new URLSearchParams(new FormData(this.form)),this.formData.set("action","get_films"),this.formData.set("page",this.page);let e=this.sortInput.value.split("|");e.length>0&&this.formData.set("orderby",e[0]),e.length>1&&this.formData.set("order",e[1]),this.page=1};getFilms=async(t=!1)=>{this.filmsNode.classList.add("is-loading"),this.prepareFilterData(t);const e=await fetch(already.ajaxurl+"?"+this.formData.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();t&&this.onSuccess(t),this.filmsNode.classList.remove("is-loading")}};onSuccess=t=>{this.filmsNode.innerHTML=t.html,t.total_count>2&&t.total_count!==t.current_count?this.loadMoreBtn.classList.add("is-show"):this.loadMoreBtn.classList.remove("is-show")};onSubmit=t=>{t.preventDefault(),this.searchInput.value="",this.getFilms()};onSearch=()=>{setTimeout((()=>{this.getFilms(!0)}),500)};onLoadMore=t=>{t.preventDefault();let e=this.loadMoreBtn.getAttribute("data-page");this.page=Number(e)+1,this.loadMoreBtn.setAttribute("data-page",this.page),this.getFilms()}}document.addEventListener("DOMContentLoaded",(()=>{(new t).init()}))}},e={};function s(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,s),r.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var a=e.getElementsByTagName("script");if(a.length)for(var i=a.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=a[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t+"../"})(),(()=>{"use strict";s(322),s.p,s.p,s.p,s.p})()})();
//# sourceMappingURL=scripts.js.map